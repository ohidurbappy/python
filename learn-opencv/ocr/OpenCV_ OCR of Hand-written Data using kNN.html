<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0065)https://docs.opencv.org/master/d8/d4b/tutorial_py_knn_opencv.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta name="generator" content="Doxygen 1.8.12">
<title>OpenCV: OCR of Hand-written Data using kNN</title>
<link href="https://docs.opencv.org/master/opencv.ico" rel="shortcut icon" type="image/x-icon">
<link href="./OpenCV_ OCR of Hand-written Data using kNN_files/tabs.css" rel="stylesheet" type="text/css">
<script async="" src="./OpenCV_ OCR of Hand-written Data using kNN_files/async-ads.js.download"></script><script type="text/javascript" async="" src="./OpenCV_ OCR of Hand-written Data using kNN_files/f.txt"></script><script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/jquery.js.download"></script>
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/dynsections.js.download"></script>
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/tutorial-utils.js.download"></script>
<link href="./OpenCV_ OCR of Hand-written Data using kNN_files/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/searchdata.js.download"></script>
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/search.js.download"></script>
<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
          fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
          forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
          forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
          vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
          vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
          hdotsfor: ["\\dots", 1],
          mathbbm: ["\\mathbb{#1}", 1],
          bordermatrix: ["\\matrix{#1}", 1]
      }
  }
}
);
//]]>
</script><script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/MathJax.js.download"></script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>
<link href="./OpenCV_ OCR of Hand-written Data using kNN_files/doxygen.css" rel="stylesheet" type="text/css">
<link href="./OpenCV_ OCR of Hand-written Data using kNN_files/stylesheet.css" rel="stylesheet" type="text/css">
<script src="./OpenCV_ OCR of Hand-written Data using kNN_files/cse_element__en.js.download" type="text/javascript"></script><link type="text/css" rel="stylesheet" href="./OpenCV_ OCR of Hand-written Data using kNN_files/default+en.css"><link type="text/css" rel="stylesheet" href="./OpenCV_ OCR of Hand-written Data using kNN_files/default.css"><style type="text/css">.gsc-control-cse{font-family:arial, sans-serif}.gsc-control-cse .gsc-table-result{font-family:arial, sans-serif}.gsc-refinementsGradient{background:linear-gradient(to left,rgba(255,255,255,1),rgba(255,255,255,0))}.gsc-control-cse{border-color:#FFFFFF;background-color:#FFFFFF}input.gsc-input,.gsc-input-box,.gsc-input-box-hover,.gsc-input-box-focus{border-color:#D9D9D9}.gsc-search-button-v2,.gsc-search-button-v2:hover,.gsc-search-button-v2:focus{border-color:#666666;background-color:#CECECE;background-image:none;filter:none}.gsc-search-button-v2 svg{fill:#FFFFFF}.gsc-tabHeader.gsc-tabhActive,.gsc-refinementHeader.gsc-refinementhActive{color:#CCCCCC;border-color:#CCCCCC;background-color:#FFFFFF}.gsc-tabHeader.gsc-tabhInactive,.gsc-refinementHeader.gsc-refinementhInactive{color:#CCCCCC;border-color:#CCCCCC;background-color:#FFFFFF}.gsc-webResult.gsc-result,.gsc-results .gsc-imageResult{border-color:#FFFFFF;background-color:#FFFFFF}.gsc-webResult.gsc-result:hover,.gsc-imageResult:hover{border-color:#FFFFFF;background-color:#FFFFFF}.gs-webResult.gs-result a.gs-title:link,.gs-webResult.gs-result a.gs-title:link b,.gs-imageResult a.gs-title:link,.gs-imageResult a.gs-title:link b{color:#0000CC}.gs-webResult.gs-result a.gs-title:visited,.gs-webResult.gs-result a.gs-title:visited b,.gs-imageResult a.gs-title:visited,.gs-imageResult a.gs-title:visited b{color:#0000CC}.gs-webResult.gs-result a.gs-title:hover,.gs-webResult.gs-result a.gs-title:hover b,.gs-imageResult a.gs-title:hover,.gs-imageResult a.gs-title:hover b{color:#0000CC}.gs-webResult.gs-result a.gs-title:active,.gs-webResult.gs-result a.gs-title:active b,.gs-imageResult a.gs-title:active,.gs-imageResult a.gs-title:active b{color:#0000CC}.gsc-cursor-page{color:#0000CC}a.gsc-trailing-more-results:link{color:#0000CC}.gs-webResult .gs-snippet,.gs-imageResult .gs-snippet,.gs-fileFormatType{color:#000000}.gs-webResult div.gs-visibleUrl,.gs-imageResult div.gs-visibleUrl{color:#008000}.gs-webResult div.gs-visibleUrl-short{color:#008000}.gs-webResult div.gs-visibleUrl-short{display:none}.gs-webResult div.gs-visibleUrl-long{display:block}.gs-promotion div.gs-visibleUrl-short{display:none}.gs-promotion div.gs-visibleUrl-long{display:block}.gsc-cursor-box{border-color:#FFFFFF}.gsc-results .gsc-cursor-box .gsc-cursor-page{border-color:#CCCCCC;background-color:#FFFFFF;color:#CCCCCC}.gsc-results .gsc-cursor-box .gsc-cursor-current-page{border-color:#CCCCCC;background-color:#FFFFFF;color:#CCCCCC}.gsc-webResult.gsc-result.gsc-promotion{border-color:#336699;background-color:#FFFFFF}.gsc-completion-title{color:#0000CC}.gsc-completion-snippet{color:#000000}.gs-promotion a.gs-title:link,.gs-promotion a.gs-title:link *,.gs-promotion .gs-snippet a:link{color:#0000CC}.gs-promotion a.gs-title:visited,.gs-promotion a.gs-title:visited *,.gs-promotion .gs-snippet a:visited{color:#0000CC}.gs-promotion a.gs-title:hover,.gs-promotion a.gs-title:hover *,.gs-promotion .gs-snippet a:hover{color:#0000CC}.gs-promotion a.gs-title:active,.gs-promotion a.gs-title:active *,.gs-promotion .gs-snippet a:active{color:#0000CC}.gs-promotion .gs-snippet,.gs-promotion .gs-title .gs-promotion-title-right,.gs-promotion .gs-title .gs-promotion-title-right *{color:#000000}.gs-promotion .gs-visibleUrl,.gs-promotion .gs-visibleUrl-short{color:#008000}.gcsc-find-more-on-google{color:#0000CC}.gcsc-find-more-on-google-magnifier{fill:#0000CC}</style><style type="text/css">.gscb_a{display:inline-block;font:27px/13px arial,sans-serif}.gsst_a .gscb_a{color:#a1b9ed;cursor:pointer}.gsst_a:hover .gscb_a,.gsst_a:focus .gscb_a{color:#36c}.gsst_a{display:inline-block}.gsst_a{cursor:pointer;padding:0 4px}.gsst_a:hover{text-decoration:none!important}.gsst_b{font-size:16px;padding:0 2px;position:relative;user-select:none;-webkit-user-select:none;white-space:nowrap}.gsst_e{vertical-align:middle;opacity:0.55;}.gsst_a:hover .gsst_e,.gsst_a:focus .gsst_e{opacity:0.72;}.gsst_a:active .gsst_e{opacity:1;}.gsst_f{background:white;text-align:left}.gsst_g{background-color:white;border:1px solid #ccc;border-top-color:#d9d9d9;box-shadow:0 2px 4px rgba(0,0,0,0.2);-webkit-box-shadow:0 2px 4px rgba(0,0,0,0.2);margin:-1px -3px;padding:0 6px}.gsst_h{background-color:white;height:1px;margin-bottom:-1px;position:relative;top:-1px}.gsib_a{width:100%;padding:4px 6px 0}.gsib_a,.gsib_b{vertical-align:top}.gssb_c{border:0;position:absolute;z-index:989}.gssb_e{border:1px solid #ccc;border-top-color:#d9d9d9;box-shadow:0 2px 4px rgba(0,0,0,0.2);-webkit-box-shadow:0 2px 4px rgba(0,0,0,0.2);cursor:default}.gssb_f{visibility:hidden;white-space:nowrap}.gssb_k{border:0;display:block;position:absolute;top:0;z-index:988}.gsdd_a{border:none!important}.gsq_a{padding:0}.gsq_a{padding:0}.gssb_a{padding:0 7px}.gssb_a,.gssb_a td{white-space:nowrap;overflow:hidden;line-height:22px}#gssb_b{font-size:11px;color:#36c;text-decoration:none}#gssb_b:hover{font-size:11px;color:#36c;text-decoration:underline}.gssb_g{text-align:center;padding:8px 0 7px;position:relative}.gssb_h{font-size:15px;height:28px;margin:0.2em;-webkit-appearance:button}.gssb_i{background:#eee}.gss_ifl{visibility:hidden;padding-left:5px}.gssb_i .gss_ifl{visibility:visible}a.gssb_j{font-size:13px;color:#36c;text-decoration:none;line-height:100%}a.gssb_j:hover{text-decoration:underline}.gssb_l{height:1px;background-color:#e5e5e5}.gssb_m{color:#000;background:#fff}.gssb_a{padding:0 9px}.gsib_a{padding:5px 9px 4px 9px}.gscb_a{line-height:27px}.gssb_e{border:0}.gssb_l{margin:5px 0}input.gsc-input::-webkit-input-placeholder{font-size:14px}input.gsc-input:-moz-placeholder{font-size:14px}input.gsc-input::-moz-placeholder{font-size:14px}input.gsc-input:-ms-input-placeholder{font-size:14px}input.gsc-input:focus::-webkit-input-placeholder{color:transparent}input.gsc-input:focus:-moz-placeholder{color:transparent}input.gsc-input:focus::-moz-placeholder{color:transparent}input.gsc-input:focus:-ms-input-placeholder{color:transparent}.gssb_c .gsc-completion-container{position:static}.gssb_c{z-index:5000}.gsc-completion-container table{background:transparent;font-size:inherit;font-family:inherit}.gssb_c > tbody > tr,.gssb_c > tbody > tr > td,.gssb_d,.gssb_d > tbody > tr,.gssb_d > tbody > tr > td,.gssb_e,.gssb_e > tbody > tr,.gssb_e > tbody > tr > td{padding:0;margin:0;border:0}.gssb_a table,.gssb_a table tr,.gssb_a table tr td{padding:0;margin:0;border:0}</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>
<body><div id="MathJax_Message" style="display: none;"></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<script>
  (function() {
    var cx = '002541620211387084530:kaexgxg7oxu';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div id="___gcse_0"><div class="gsc-control-cse gsc-control-cse-en"><div class="gsc-control-wrapper-cse" dir="ltr"><form class="gsc-search-box gsc-search-box-tools" accept-charset="utf-8"><table cellspacing="0" cellpadding="0" class="gsc-search-box"><tbody><tr><td class="gsc-input"><div class="gsc-input-box" id="gsc-iw-id1"><table cellspacing="0" cellpadding="0" id="gs_id50" class="gstl_50 gsc-input" style="width: 100%; padding: 0px;"><tbody><tr><td id="gs_tti50" class="gsib_a"><input autocomplete="off" type="text" size="10" class="gsc-input" name="search" title="search" id="gsc-i-id1" placeholder="Custom Search" style="width: 100%; padding: 0px; border: none; margin: 0px; height: auto; background: url(&quot;https://www.google.com/cse/static/images/1x/googlelogo_lightgrey_46x16dp.png&quot;) left center no-repeat rgb(255, 255, 255); text-indent: 48px; outline: none;" dir="ltr" spellcheck="false" x-webkit-grammar="builtin:search" lang="en"></td><td class="gsib_b"><div class="gsst_b" id="gs_st50" dir="ltr"><a class="gsst_a" href="javascript:void(0)" style="display: none;" title="Clear search box" role="button"><span class="gscb_a" id="gs_cb50" aria-hidden="true">×</span></a></div></td></tr></tbody></table></div></td><td class="gsc-search-button"><button class="gsc-search-button gsc-search-button-v2"><svg width="13" height="13" viewBox="0 0 13 13"><title>search</title><path d="m4.8495 7.8226c0.82666 0 1.5262-0.29146 2.0985-0.87438 0.57232-0.58292 0.86378-1.2877 0.87438-2.1144 0.010599-0.82666-0.28086-1.5262-0.87438-2.0985-0.59352-0.57232-1.293-0.86378-2.0985-0.87438-0.8055-0.010599-1.5103 0.28086-2.1144 0.87438-0.60414 0.59352-0.8956 1.293-0.87438 2.0985 0.021197 0.8055 0.31266 1.5103 0.87438 2.1144 0.56172 0.60414 1.2665 0.8956 2.1144 0.87438zm4.4695 0.2115 3.681 3.6819-1.259 1.284-3.6817-3.7 0.0019784-0.69479-0.090043-0.098846c-0.87973 0.76087-1.92 1.1413-3.1207 1.1413-1.3553 0-2.5025-0.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239c0-1.3553 0.4696-2.4966 1.4088-3.4239 0.9392-0.92727 2.0864-1.3969 3.4417-1.4088 1.3553-0.011889 2.4906 0.45771 3.406 1.4088 0.9154 0.95107 1.379 2.0924 1.3909 3.4239 0 1.2126-0.38043 2.2588-1.1413 3.1385l0.098834 0.090049z"></path></svg></button></td><td class="gsc-clear-button"><div class="gsc-clear-button" title="clear results">&nbsp;</div></td></tr></tbody></table></form><div class="gsc-results-wrapper-overlay"><div class="gsc-results-close-btn" tabindex="0"></div><div class="gsc-positioningWrapper"><div class="gsc-tabsAreaInvisible"><div class="gsc-tabHeader gsc-inline-block gsc-tabhActive">Custom Search</div><span class="gs-spacer"> </span></div></div><div class="gsc-positioningWrapper"><div class="gsc-tabsAreaInvisible"></div></div><div class="gsc-above-wrapper-area-invisible"><table cellspacing="0" cellpadding="0" class="gsc-above-wrapper-area-container"><tbody><tr><td class="gsc-result-info-container"><div class="gsc-result-info-invisible"></div></td><td class="gsc-orderby-container"><div class="gsc-orderby-invisible"><div class="gsc-orderby-label gsc-inline-block">Sort by:</div><div class="gsc-option-menu-container gsc-inline-block"><div class="gsc-selected-option-container gsc-inline-block"><div class="gsc-selected-option">Relevance</div><div class="gsc-option-selector"></div></div><div class="gsc-option-menu-invisible"><div class="gsc-option-menu-item gsc-option-menu-item-highlighted"><div class="gsc-option">Relevance</div></div><div class="gsc-option-menu-item"><div class="gsc-option">Date</div></div></div></div></div></td></tr></tbody></table></div><div class="gsc-adBlockInvisible"></div><div class="gsc-wrapper"><div class="gsc-adBlockInvisible"></div><div class="gsc-resultsbox-invisible"><div class="gsc-resultsRoot gsc-tabData gsc-tabdActive"><div><div class="gsc-expansionArea"></div></div></div></div></div></div><div class="gsc-modal-background-image" tabindex="0"></div></div></div></div>
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/version.js.download"></script>

<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="./OpenCV_ OCR of Hand-written Data using kNN_files/opencv-logo-small.png"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &nbsp;<span id="projectnumber"><select><option value="4.1.2-pre" selected="selected">4.1.2-pre</option><option value="4.1.1">4.1.1</option><option value="4.1.0">4.1.0</option><option value="4.0.1">4.0.1</option><option value="4.0.0">4.0.0</option><option value="4.0.0-rc">4.0.0-rc</option><option value="4.0.0-beta">4.0.0-beta</option><option value="4.0.0-alpha">4.0.0-alpha</option><option value="3.4.8-pre">3.4.8-pre</option><option value="3.4.7">3.4.7</option><option value="3.4.6">3.4.6</option><option value="3.4.5">3.4.5</option><option value="3.4.4">3.4.4</option><option value="3.4.3">3.4.3</option><option value="3.4.2">3.4.2</option><option value="3.4.1">3.4.1</option><option value="3.4.0">3.4.0</option><option value="3.3.1">3.3.1</option><option value="3.3.0">3.3.0</option><option value="3.2.0">3.2.0</option><option value="3.1.0">3.1.0</option><option value="3.0.0">3.0.0</option></select></span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/menudata.js.download"></script>
<script type="text/javascript" src="./OpenCV_ OCR of Hand-written Data using kNN_files/menu.js.download"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"><ul class="sm sm-dox" id="main-menu" data-smartmenus-id="15703667617134714"><li><a href="https://docs.opencv.org/master/index.html">Main Page</a></li><li><a href="https://docs.opencv.org/master/pages.html">Related Pages</a></li><li><a href="https://docs.opencv.org/master/modules.html">Modules</a></li><li><a href="https://docs.opencv.org/master/namespaces.html" class="has-submenu" id="sm-15703667617134714-1" aria-haspopup="true" aria-controls="sm-15703667617134714-2" aria-expanded="false"><span class="sub-arrow">+</span>Namespaces</a><ul id="sm-15703667617134714-2" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-1" aria-expanded="false"><li><a href="https://docs.opencv.org/master/namespaces.html">Namespace List</a></li></ul></li><li><a href="https://docs.opencv.org/master/annotated.html" class="has-submenu" id="sm-15703667617134714-3" aria-haspopup="true" aria-controls="sm-15703667617134714-4" aria-expanded="false"><span class="sub-arrow">+</span>Classes</a><ul id="sm-15703667617134714-4" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-3" aria-expanded="false"><li><a href="https://docs.opencv.org/master/annotated.html">Class List</a></li><li><a href="https://docs.opencv.org/master/classes.html">Class Index</a></li></ul></li><li><a href="https://docs.opencv.org/master/files.html" class="has-submenu" id="sm-15703667617134714-5" aria-haspopup="true" aria-controls="sm-15703667617134714-6" aria-expanded="false"><span class="sub-arrow">+</span>Files</a><ul id="sm-15703667617134714-6" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-5" aria-expanded="false"><li><a href="https://docs.opencv.org/master/files.html">Files index</a></li><li><a href="https://docs.opencv.org/master/globals.html" class="has-submenu" id="sm-15703667617134714-7" aria-haspopup="true" aria-controls="sm-15703667617134714-8" aria-expanded="false"><span class="sub-arrow">+</span>Global objects</a><ul id="sm-15703667617134714-8" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-7" aria-expanded="false"><li><a href="https://docs.opencv.org/master/globals.html" class="has-submenu" id="sm-15703667617134714-9" aria-haspopup="true" aria-controls="sm-15703667617134714-10" aria-expanded="false"><span class="sub-arrow">+</span>All</a><ul id="sm-15703667617134714-10" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-9" aria-expanded="false"><li><a href="https://docs.opencv.org/master/globals.html#index__">_</a></li><li><a href="https://docs.opencv.org/master/globals_a.html#index_a">a</a></li><li><a href="https://docs.opencv.org/master/globals_c.html#index_c">c</a></li><li><a href="https://docs.opencv.org/master/globals_d.html#index_d">d</a></li><li><a href="https://docs.opencv.org/master/globals_f.html#index_f">f</a></li><li><a href="https://docs.opencv.org/master/globals_g.html#index_g">g</a></li><li><a href="https://docs.opencv.org/master/globals_h.html#index_h">h</a></li><li><a href="https://docs.opencv.org/master/globals_i.html#index_i">i</a></li><li><a href="https://docs.opencv.org/master/globals_k.html#index_k">k</a></li><li><a href="https://docs.opencv.org/master/globals_l.html#index_l">l</a></li><li><a href="https://docs.opencv.org/master/globals_m.html#index_m">m</a></li><li><a href="https://docs.opencv.org/master/globals_n.html#index_n">n</a></li><li><a href="https://docs.opencv.org/master/globals_o.html#index_o">o</a></li><li><a href="https://docs.opencv.org/master/globals_p.html#index_p">p</a></li><li><a href="https://docs.opencv.org/master/globals_r.html#index_r">r</a></li><li><a href="https://docs.opencv.org/master/globals_s.html#index_s">s</a></li><li><a href="https://docs.opencv.org/master/globals_t.html#index_t">t</a></li><li><a href="https://docs.opencv.org/master/globals_u.html#index_u">u</a></li><li><a href="https://docs.opencv.org/master/globals_v.html#index_v">v</a></li></ul></li><li><a href="https://docs.opencv.org/master/globals_func.html" class="has-submenu" id="sm-15703667617134714-11" aria-haspopup="true" aria-controls="sm-15703667617134714-12" aria-expanded="false"><span class="sub-arrow">+</span>Functions</a><ul id="sm-15703667617134714-12" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-11" aria-expanded="false"><li><a href="https://docs.opencv.org/master/globals_func.html#index__">_</a></li><li><a href="https://docs.opencv.org/master/globals_func_a.html#index_a">a</a></li><li><a href="https://docs.opencv.org/master/globals_func_c.html#index_c">c</a></li><li><a href="https://docs.opencv.org/master/globals_func_h.html#index_h">h</a></li><li><a href="https://docs.opencv.org/master/globals_func_m.html#index_m">m</a></li><li><a href="https://docs.opencv.org/master/globals_func_n.html#index_n">n</a></li><li><a href="https://docs.opencv.org/master/globals_func_o.html#index_o">o</a></li><li><a href="https://docs.opencv.org/master/globals_func_p.html#index_p">p</a></li><li><a href="https://docs.opencv.org/master/globals_func_u.html#index_u">u</a></li></ul></li><li><a href="https://docs.opencv.org/master/globals_vars.html">Variables</a></li><li><a href="https://docs.opencv.org/master/globals_type.html" class="has-submenu" id="sm-15703667617134714-13" aria-haspopup="true" aria-controls="sm-15703667617134714-14" aria-expanded="false"><span class="sub-arrow">+</span>Typedefs</a><ul id="sm-15703667617134714-14" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-13" aria-expanded="false"><li><a href="https://docs.opencv.org/master/globals_type.html#index_c">c</a></li><li><a href="https://docs.opencv.org/master/globals_type.html#index_i">i</a></li><li><a href="https://docs.opencv.org/master/globals_type.html#index_n">n</a></li><li><a href="https://docs.opencv.org/master/globals_type.html#index_s">s</a></li><li><a href="https://docs.opencv.org/master/globals_type.html#index_u">u</a></li><li><a href="https://docs.opencv.org/master/globals_type.html#index_v">v</a></li></ul></li><li><a href="https://docs.opencv.org/master/globals_enum.html">Enumerations</a></li><li><a href="https://docs.opencv.org/master/globals_eval.html" class="has-submenu" id="sm-15703667617134714-15" aria-haspopup="true" aria-controls="sm-15703667617134714-16" aria-expanded="false"><span class="sub-arrow">+</span>Enumerator</a><ul id="sm-15703667617134714-16" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-15" aria-expanded="false"><li><a href="https://docs.opencv.org/master/globals_eval.html#index_c">c</a></li><li><a href="https://docs.opencv.org/master/globals_eval.html#index_n">n</a></li></ul></li><li><a href="https://docs.opencv.org/master/globals_defs.html" class="has-submenu" id="sm-15703667617134714-17" aria-haspopup="true" aria-controls="sm-15703667617134714-18" aria-expanded="false"><span class="sub-arrow">+</span>Macros</a><ul id="sm-15703667617134714-18" role="group" aria-hidden="true" aria-labelledby="sm-15703667617134714-17" aria-expanded="false"><li><a href="https://docs.opencv.org/master/globals_defs.html#index__">_</a></li><li><a href="https://docs.opencv.org/master/globals_defs_c.html#index_c">c</a></li><li><a href="https://docs.opencv.org/master/globals_defs_d.html#index_d">d</a></li><li><a href="https://docs.opencv.org/master/globals_defs_f.html#index_f">f</a></li><li><a href="https://docs.opencv.org/master/globals_defs_g.html#index_g">g</a></li><li><a href="https://docs.opencv.org/master/globals_defs_h.html#index_h">h</a></li><li><a href="https://docs.opencv.org/master/globals_defs_i.html#index_i">i</a></li><li><a href="https://docs.opencv.org/master/globals_defs_l.html#index_l">l</a></li><li><a href="https://docs.opencv.org/master/globals_defs_m.html#index_m">m</a></li><li><a href="https://docs.opencv.org/master/globals_defs_n.html#index_n">n</a></li><li><a href="https://docs.opencv.org/master/globals_defs_o.html#index_o">o</a></li><li><a href="https://docs.opencv.org/master/globals_defs_r.html#index_r">r</a></li><li><a href="https://docs.opencv.org/master/globals_defs_s.html#index_s">s</a></li><li><a href="https://docs.opencv.org/master/globals_defs_t.html#index_t">t</a></li><li><a href="https://docs.opencv.org/master/globals_defs_u.html#index_u">u</a></li><li><a href="https://docs.opencv.org/master/globals_defs_v.html#index_v">v</a></li></ul></li></ul></li></ul></li><li><a href="https://docs.opencv.org/master/examples.html">Examples</a></li><li><a href="https://docs.opencv.org/master/javadoc/index.html">Java documentation</a></li><li style="float:right"><div id="MSearchBox" class="MSearchBoxInactive"><span class="left"><img id="MSearchSelect" src="./OpenCV_ OCR of Hand-written Data using kNN_files/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt=""><input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)"></span><span class="right"><a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="./OpenCV_ OCR of Hand-written Data using kNN_files/close.png" alt=""></a></span></div></li></ul></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" onclick="searchBox.OnSelectItem(0)" href="javascript:void(0)"><span class="SelectionMark">•</span>All</a><a class="SelectItem" onclick="searchBox.OnSelectItem(1)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" onclick="searchBox.OnSelectItem(2)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" onclick="searchBox.OnSelectItem(3)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" onclick="searchBox.OnSelectItem(4)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" onclick="searchBox.OnSelectItem(5)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" onclick="searchBox.OnSelectItem(6)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" onclick="searchBox.OnSelectItem(7)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" onclick="searchBox.OnSelectItem(8)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" onclick="searchBox.OnSelectItem(9)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Properties</a><a class="SelectItem" onclick="searchBox.OnSelectItem(10)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" onclick="searchBox.OnSelectItem(11)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Macros</a><a class="SelectItem" onclick="searchBox.OnSelectItem(12)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Modules</a><a class="SelectItem" onclick="searchBox.OnSelectItem(13)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults" src="./OpenCV_ OCR of Hand-written Data using kNN_files/saved_resource.html">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="https://docs.opencv.org/master/d6/d00/tutorial_py_root.html">OpenCV-Python Tutorials</a></li><li class="navelem"><a class="el" href="https://docs.opencv.org/master/d6/de2/tutorial_py_table_of_contents_ml.html">Machine Learning</a></li><li class="navelem"><a class="el" href="https://docs.opencv.org/master/d0/d72/tutorial_py_knn_index.html">K-Nearest Neighbour</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">OCR of Hand-written Data using kNN </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Goal </h2>
<p>In this chapter</p><ul>
<li>We will use our knowledge on kNN to build a basic OCR application.</li>
<li>We will try with Digits and Alphabets data available that comes with OpenCV.</li>
</ul>
<h2>OCR of Hand-written Digits </h2>
<p>Our goal is to build an application which can read the handwritten digits. For this we need some train_data and test_data. OpenCV comes with an image digits.png (in the folder opencv/samples/data/) which has 5000 handwritten digits (500 for each digit). Each digit is a 20x20 image. So our first step is to split this image into 5000 different digits. For each digit, we flatten it into a single row with 400 pixels. That is our feature set, ie intensity values of all pixels. It is the simplest feature set we can create. We use first 250 samples of each digit as train_data, and next 250 samples as test_data. So let's prepare them first. </p><div class="fragment"><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</div><div class="line"></div><div class="line">img = <a class="code" href="https://docs.opencv.org/master/d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56">cv.imread</a>(<span class="stringliteral">'digits.png'</span>)</div><div class="line">gray = <a class="code" href="https://docs.opencv.org/master/d8/d01/group__imgproc__color__conversions.html#ga397ae87e1288a81d2363b61574eb8cab">cv.cvtColor</a>(img,cv.COLOR_BGR2GRAY)</div><div class="line"></div><div class="line"><span class="comment"># Now we split the image to 5000 cells, each 20x20 size</span></div><div class="line">cells = [np.hsplit(row,100) <span class="keywordflow">for</span> row <span class="keywordflow">in</span> np.vsplit(gray,50)]</div><div class="line"></div><div class="line"><span class="comment"># Make it into a Numpy array. It size will be (50,100,20,20)</span></div><div class="line">x = np.array(cells)</div><div class="line"></div><div class="line"><span class="comment"># Now we prepare train_data and test_data.</span></div><div class="line">train = x[:,:50].reshape(-1,400).astype(np.float32) <span class="comment"># Size = (2500,400)</span></div><div class="line">test = x[:,50:100].reshape(-1,400).astype(np.float32) <span class="comment"># Size = (2500,400)</span></div><div class="line"></div><div class="line"><span class="comment"># Create labels for train and test data</span></div><div class="line">k = np.arange(10)</div><div class="line">train_labels = np.repeat(k,250)[:,np.newaxis]</div><div class="line">test_labels = train_labels.copy()</div><div class="line"></div><div class="line"><span class="comment"># Initiate kNN, train the data, then test it with test data for k=1</span></div><div class="line">knn = cv.ml.KNearest_create()</div><div class="line">knn.train(train, cv.ml.ROW_SAMPLE, train_labels)</div><div class="line">ret,result,neighbours,dist = knn.findNearest(test,k=5)</div><div class="line"></div><div class="line"><span class="comment"># Now we check the accuracy of classification</span></div><div class="line"><span class="comment"># For that, compare the result with test_labels and check which are wrong</span></div><div class="line">matches = result==test_labels</div><div class="line">correct = np.count_nonzero(matches)</div><div class="line">accuracy = correct*100.0/result.size</div><div class="line"><a class="code" href="https://docs.opencv.org/master/df/d57/namespacecv_1_1dnn.html#a701210a0203f2786cbfd04b2bd56da47">print</a>( accuracy )</div></div><!-- fragment --><p> So our basic OCR app is ready. This particular example gave me an accuracy of 91%. One option improve accuracy is to add more data for training, especially the wrong ones. So instead of finding this training data everytime I start application, I better save it, so that next time, I directly read this data from a file and start classification. You can do it with the help of some Numpy functions like np.savetxt, np.savez, np.load etc. Please check their docs for more details. </p><div class="fragment"><div class="line"><span class="comment"># save the data</span></div><div class="line">np.savez(<span class="stringliteral">'knn_data.npz'</span>,train=train, train_labels=train_labels)</div><div class="line"></div><div class="line"><span class="comment"># Now load the data</span></div><div class="line">with np.load(<span class="stringliteral">'knn_data.npz'</span>) <span class="keyword">as</span> data:</div><div class="line">    <a class="code" href="https://docs.opencv.org/master/df/d57/namespacecv_1_1dnn.html#a701210a0203f2786cbfd04b2bd56da47">print</a>( data.files )</div><div class="line">    train = data[<span class="stringliteral">'train'</span>]</div><div class="line">    train_labels = data[<span class="stringliteral">'train_labels'</span>]</div></div><!-- fragment --><p> In my system, it takes around 4.4 MB of memory. Since we are using intensity values (uint8 data) as features, it would be better to convert the data to np.uint8 first and then save it. It takes only 1.1 MB in this case. Then while loading, you can convert back into float32.</p>
<h2>OCR of English Alphabets </h2>
<p>Next we will do the same for English alphabets, but there is a slight change in data and feature set. Here, instead of images, OpenCV comes with a data file, letter-recognition.data in opencv/samples/cpp/ folder. If you open it, you will see 20000 lines which may, on first sight, look like garbage. Actually, in each row, first column is an alphabet which is our label. Next 16 numbers following it are its different features. These features are obtained from <a href="http://archive.ics.uci.edu/ml/">UCI Machine Learning Repository</a>. You can find the details of these features in <a href="http://archive.ics.uci.edu/ml/datasets/Letter+Recognition">this page</a>.</p>
<p>There are 20000 samples available, so we take first 10000 data as training samples and remaining 10000 as test samples. We should change the alphabets to ascii characters because we can't work with alphabets directly. </p><div class="fragment"><div class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line"><span class="comment"># Load the data, converters convert the letter to a number</span></div><div class="line">data= np.loadtxt(<span class="stringliteral">'letter-recognition.data'</span>, dtype= <span class="stringliteral">'float32'</span>, delimiter = <span class="stringliteral">','</span>,</div><div class="line">                    converters= {0: <span class="keyword">lambda</span> ch: ord(ch)-ord(<span class="stringliteral">'A'</span>)})</div><div class="line"></div><div class="line"><span class="comment"># split the data to two, 10000 each for train and test</span></div><div class="line">train, test = np.vsplit(data,2)</div><div class="line"></div><div class="line"><span class="comment"># split trainData and testData to features and responses</span></div><div class="line">responses, trainData = np.hsplit(train,[1])</div><div class="line">labels, testData = np.hsplit(test,[1])</div><div class="line"></div><div class="line"><span class="comment"># Initiate the kNN, classify, measure accuracy.</span></div><div class="line">knn = cv.ml.KNearest_create()</div><div class="line">knn.train(trainData, cv.ml.ROW_SAMPLE, responses)</div><div class="line">ret, result, neighbours, dist = knn.findNearest(testData, k=5)</div><div class="line"></div><div class="line">correct = np.count_nonzero(result == labels)</div><div class="line">accuracy = correct*100.0/10000</div><div class="line"><a class="code" href="https://docs.opencv.org/master/df/d57/namespacecv_1_1dnn.html#a701210a0203f2786cbfd04b2bd56da47">print</a>( accuracy )</div></div><!-- fragment --><p> It gives me an accuracy of 93.22%. Again, if you want to increase accuracy, you can iteratively add error data in each level.</p>
<h2>Additional Resources </h2>
<h2>Exercises </h2>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"><address class="footer"><small>
Generated on Sun Oct 6 2019 05:42:01 for OpenCV by &nbsp;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="./OpenCV_ OCR of Hand-written Data using kNN_files/doxygen.png" alt="doxygen">
</a> 1.8.12
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>


<table cellspacing="0" cellpadding="0" class="gstl_50 gssb_c" style="width: 1238px; display: none; top: 45px; position: absolute; left: 14px;"><tbody><tr><td class="gssb_f"></td><td class="gssb_e" style="width: 100%;"></td></tr></tbody></table></body></html>